import pandas as pd

# (base) joel@mountainsense:~/sim/qmap$ head wfj_long.csv 
# datetime,DW,ILWR,ISWR,P,PINT,PSUM,RH,Rf,Sf,TA,VW
# 1980-01-01 00:00:00,327.258,223.691,0.000,107449.344,0.689,0.689,1.000,0.000,0.689,257.942,8.471
# 1980-01-01 03:00:00,316.736,173.298,0.000,107872.007,0.108,0.108,0.931,0.000,0.108,257.100,6.807
# 1980-01-01 06:00:00,325.147,174.464,0.000,106527.939,0.085,0.085,0.918,0.000,0.085,255.947,7.119
# 1980-01-01 09:00:00,331.520,202.217,80.027,107337.395,0.052,0.052,0.843,0.000,0.052,255.862,4.978
# 1980-01-01 12:00:00,318.301,144.879,186.977,107113.866,0.006,0.006,0.726,0.000,0.006,256.873,2.986
# 1980-01-01 15:00:00,318.080,140.329,49.819,106242.692,0.000,0.000,0.605,0.000,0.000,257.557,3.054
# 1980-01-01 18:00:00,319.838,198.147,0.000,106836.497,0.014,0.014,0.715,0.000,0.014,257.371,3.819
# 1980-01-01 21:00:00,314.989,167.776,0.000,106454.632,0.013,0.013,0.829,0.000,0.013,257.172,3.664
# 1980-01-02 00:00:00,315.412,204.371,0.000,106156.699,0.084,0.084,0.957,0.000,0.084,256.493,4.026


# (base) joel@mountainsense:~/sim/qmap$ head wfj_long_1H.csv 
# datetime,DW,ILWR,ISWR,P,PINT,PSUM,RH,Rf,Sf,TA,VW
# 1980-01-01 00:00:00,327.25800000,223.69100000,0.00000000,107449.34400000,0.68900000,0.68900000,1.00000000,0.00000000,0.68900000,257.94200000,8.47100000
# 1980-01-01 01:00:00,323.75066667,206.89333333,0.00000000,107590.23166667,0.49533333,0.49533333,0.97700000,0.00000000,0.49533333,257.66133333,7.91633333
# 1980-01-01 02:00:00,320.24333333,190.09566667,0.00000000,107731.11933333,0.30166667,0.30166667,0.95400000,0.00000000,0.30166667,257.38066667,7.36166667
# 1980-01-01 03:00:00,316.73600000,173.29800000,0.00000000,107872.00700000,0.10800000,0.10800000,0.93100000,0.00000000,0.10800000,257.10000000,6.80700000
# 1980-01-01 04:00:00,319.53966667,173.68666667,0.00000000,107423.98433333,0.10033333,0.10033333,0.92666667,0.00000000,0.10033333,256.71566667,6.91100000
# 1980-01-01 05:00:00,322.34333333,174.07533333,0.00000000,106975.96166667,0.09266667,0.09266667,0.92233333,0.00000000,0.09266667,256.33133333,7.01500000
# 1980-01-01 06:00:00,325.14700000,174.46400000,0.00000000,106527.93900000,0.08500000,0.08500000,0.91800000,0.00000000,0.08500000,255.94700000,7.11900000
# 1980-01-01 07:00:00,327.27133333,183.71500000,26.67566667,106797.75766667,0.07400000,0.07400000,0.89300000,0.00000000,0.07400000,255.91866667,6.40533333
# 1980-01-01 08:00:00,329.39566667,192.96600000,53.35133333,107067.57633333,0.06300000,0.06300000,0.86800000,0.00000000,0.06300000,255.89033333,5.69166667


def main(path_inp):# create 1h wfj era5 obs data by

	#path_inp = "/home/joel/sim/qmap/wfj_long.csv"
	
	df_obs= pd.read_csv(path_inp, index_col=0, parse_dates=True)
	df_1h = df_obs.resample('1H').interpolate()
	df_1h.to_csv(path_or_buf=path_inp.split('.')[0]  + '_1H.csv' ,na_rep=-999,float_format='%.3f', header=True, sep=',')
	return(path_inp.split('.')[0]  + '_1H.csv')

#====================================================================
#	Calling MAIN
#====================================================================
if __name__ == '__main__':
	import sys
	path_inp      = sys.argv[1]
	main(path_inp)
